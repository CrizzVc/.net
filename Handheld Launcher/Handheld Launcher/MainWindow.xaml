<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Handheld_Launcher.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Handheld_Launcher"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Handheld Launcher">


    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid x:Name="RootGrid"
          KeyDown="RootGrid_KeyDown"
          IsTabStop="True">

        <Grid.Resources>
            <local:BoolToWidthConverter x:Key="BoolToWidthConverter" />
            
        </Grid.Resources>

        <!-- COLUMNAS -->
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="80"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- FILAS -->
        <Grid.RowDefinitions>
            <RowDefinition Height="9*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="50" />
        </Grid.RowDefinitions>

        <!-- SIDEBAR -->
        <Grid x:Name="LeftSidebar"
              Grid.Column="0"
              Grid.RowSpan="3"
              Background="#16171b">

            <StackPanel VerticalAlignment="Center"
                        HorizontalAlignment="Center"
                        Spacing="25">

                <Button Click="Home_Click" Width="50" Height="50" CornerRadius="10">
                    <FontIcon Glyph="&#xE80F;" FontFamily="Segoe MDL2 Assets" FontSize="24"/>
                </Button>

                <Button Click="Library_Click" Width="50" Height="50" CornerRadius="10">
                    <FontIcon Glyph="&#xe74c;" FontFamily="Segoe MDL2 Assets" FontSize="24"/>
                </Button>

                <Button Click="AddGame_Click" Width="50" Height="50" CornerRadius="10">

                    <FontIcon Glyph="&#xe948;" FontFamily="Segoe MDL2 Assets" FontSize="24"/>
                </Button>

                <Button Width="50" Height="50" CornerRadius="10">
                    <Button.Flyout>
                        <MenuFlyout>
                            <MenuFlyoutItem Text="Color sólido" Click="Solid_Click"/>
                            <MenuFlyoutItem Text="Degradado" Click="Gradient_Click"/>
                            <MenuFlyoutItem Text="Imagen" Click="Image_Click"/>
                        </MenuFlyout>
                    </Button.Flyout>
                    <FontIcon Glyph="&#xe713;" FontFamily="Segoe MDL2 Assets" FontSize="24"/>
                </Button>

            </StackPanel>

        </Grid>

        

        <!-- BACKGROUND -->
        <Image x:Name="BackgroundImage"
               Grid.Column="1"
               Stretch="UniformToFill"
               Grid.RowSpan="3"/>

        <!-- GRADIENT OVERLAY -->
        <Grid Grid.Column="1" Grid.RowSpan="3">
            <Grid.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                    <GradientStop Color="#00000000" Offset="0"/>
                    <GradientStop Color="#00000000" Offset="0.6"/>
                    <GradientStop Color="#CC000000" Offset="1"/>
                </LinearGradientBrush>
            </Grid.Background>
        </Grid>

        <Grid Grid.Column="1" Grid.Row="0">
            <FontIcon Glyph="&#xE856;"
              FontFamily="Segoe MDL2 Assets"
              FontSize="35"
              Foreground="White"
              HorizontalAlignment="Right"
              VerticalAlignment="Top"
              Margin="0,30,115,0"/>
        </Grid>
        <!-- CLOCK -->
        <TextBlock x:Name="TimeTextBlock"
                   Grid.Column="1"
                   Grid.Row="0"
                   HorizontalAlignment="Right"
                   VerticalAlignment="Top"
                   Margin="0,30,40,0"
                   FontSize="26"
                   FontWeight="SemiBold"
                   Foreground="White"/>

        <!-- CONTENEDOR DE VISTAS -->
        <Grid Grid.Column="1" Grid.Row="1">

            <!-- HOME VIEW -->
            <StackPanel x:Name="HomeView" Padding="40,0">

                <StackPanel Orientation="Horizontal" Spacing="20" Margin="0,0,0,20">
                    <TextBlock Text="MIS JUEGOS"
                               FontWeight="Bold"
                               FontSize="28"
                               Foreground="White"/>
                   
                </StackPanel>

                <ScrollViewer x:Name="CarouselScrollViewer"
                              HorizontalScrollMode="Enabled"
                              HorizontalScrollBarVisibility="Hidden"
                              VerticalScrollMode="Disabled">

                    <GridView x:Name="CarouselGrid"
                              ItemsSource="{x:Bind OtherGames, Mode=OneWay}"
                              IsItemClickEnabled="True"
                              ItemClick="CarouselGrid_ItemClick"
                              SelectionMode="Single">

                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>

                        <GridView.ItemTemplate>
                            <DataTemplate x:DataType="local:GameItem">
                                <StackPanel Width="{Binding IsLarge, Converter={StaticResource BoolToWidthConverter}}" Margin="14">
                                    <Border Height="260" CornerRadius="12" Background="#222" Width="{Binding IsLarge, Converter={StaticResource BoolToWidthConverter}}">
                                        <Image Source="{x:Bind DisplayImage}" Stretch="UniformToFill"/>
                                    </Border>
                                    <TextBlock Text="{x:Bind Name}" Foreground="White" Margin="0,10,0,0" TextWrapping="Wrap"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridView.ItemTemplate>

                    </GridView>
                </ScrollViewer>

            </StackPanel>

            

            <!-- LIBRARY VIEW -->
            <Grid x:Name="LibraryView"
                  Visibility="Collapsed"
                  Height="1060"
                  ScrollViewer.VerticalScrollBarVisibility="Auto"
                  Padding="40">
                  

                <Grid.Background>
                    <SolidColorBrush Color="#AA000000" />
                    <!-- negro semi-transparente -->
                </Grid.Background>

                <StackPanel>

                    <TextBlock Text="BIBLIOTECA"
                               FontSize="40"
                               Foreground="White"
                               Margin="0,0,0,30"/>

                    <GridView x:Name="LibraryGrid"
                              ItemsSource="{x:Bind OtherGames, Mode=OneWay}"
                              IsItemClickEnabled="True"
                              ItemClick="LibraryGrid_ItemClick"
                              SelectionMode="Single">

                        <GridView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid Orientation="Horizontal"
                                               MaximumRowsOrColumns="6"/>
                            </ItemsPanelTemplate>
                        </GridView.ItemsPanel>

                        <GridView.ItemTemplate>
                            <DataTemplate x:DataType="local:GameItem">
                                <StackPanel Width="200" Margin="12">
                                    <Border Height="260"
                                            CornerRadius="12"
                                            Background="#222">
                                        <Image Source="{x:Bind DisplayImage}"
                                               Stretch="UniformToFill"/>
                                    </Border>
                                    <TextBlock Text="{x:Bind Name}"
                                               Foreground="White"
                                               Margin="0,10,0,0"
                                               TextWrapping="Wrap"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridView.ItemTemplate>

                    </GridView>

                </StackPanel>
            </Grid>

            <Grid x:Name="DetailOverlay" Grid.RowSpan="3" Visibility="Collapsed" Background="#FF000000" IsHitTestVisible="False">
                <Image Source="{Binding SelectedGame.BackgroundOrIcon}" Stretch="UniformToFill" Opacity="0.35"/>
                <Rectangle>
                    <Rectangle.Fill>
                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                            <GradientStop Color="#00000000" Offset="0.0"/>
                            <GradientStop Color="#B3000000" Offset="0.6"/>
                        </LinearGradientBrush>
                    </Rectangle.Fill>
                </Rectangle>
                <StackPanel HorizontalAlignment="Left" VerticalAlignment="Center" Margin="80" MaxWidth="900" IsHitTestVisible="True">
                    <TextBlock Text="{Binding SelectedGame.Name}" FontSize="72" FontFamily="ms-appx:///Assets/GoogleSans-Variable.ttf#Google Sans" FontWeight="SemiBold" Foreground="White" TextWrapping="Wrap" />
                    <StackPanel Orientation="Horizontal" Spacing="20" Margin="0,24,0,0">
                        <Button Content="▶ PLAY" Click="PlaySelectedGame_Click" Style="{StaticResource AccentButtonStyle}" Width="160" Height="48" />
                        <Button Content="Cerrar" Click="HideDetail_Click" Width="120" Height="48" />
                        <Button Content="⋯" Width="48" Height="48" FontSize="22" Click="OpenGameOptions_Click"/>
                    </StackPanel>
                </StackPanel>
            </Grid>

        </Grid>

    </Grid>
</Window>